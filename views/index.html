<!DOCTYPE html>

<html>
  <head>
    <meta charset="UTF-8">
    <title>Hello World!</title>
    <link type="text/css" rel="stylesheet" href="css/main.css" />

    <script src="d3.js"></script>
    <script src="radar.js"></script>

    <style>
    svg, ul {
        float: left;
    }
    svg text.name { font-family: Arial, Sans-serif; font-size: 12px; opacity: 0.5 }
    svg line.quadrant { stroke-width: 2px;}
    svg circle.horizon { stroke: #999; stroke-width: 2px; stroke-opacity: 0; fill: none;}
    svg line.direction { stroke: black; stroke-width: 5px; marker-end: url(#arrow); opacity: 0.2;}
    /*svg #arrow { fill: #000; }*/
    svg #arrow { fill: transparent; }
    svg path.quadrant { fill-opacity: 0.5;}
    svg text.quadrant {
        font-family: Arial, Sans-serif;
        font-weight: bold;
        color: white;
        opacity: 0.3;
        font-size: 40px;
        text-align: right;
    }
    </style>

  </head>
  <body>
      <div class="left-hand-panel">
        Organisation
        <input type="text" id="orgInput"></input>
        <button id="crawlBtn">Go</button>
      </div>
      <div class="main-panel">
          <div id="radar" style="width: 1024px; height: 800px"></div>
      </div>
  </body>

  <script>
function entry(start, end, quadrant, position, position_angle, direction, direction_angle) {
	return {
		// start date that this entry applies for
		start: start,
		// end date for the entry
		end: end,
		// the quadrant label
		quadrant: quadrant,
		// position is within the total of horizons.
		position: position,
		// angles are fractions of pi/2 (ie of a quadrant)
		position_angle: position_angle,
		// the learning end point with the total of horizons.
		direction: direction,
		// angles are fractions of pi/2 (ie of a quadrant)
		direction_angle: direction_angle
	};
}
    
    var example = {
        'data': [
            { 'language':'C#' , 'count': 500 },
            { 'language':'Python' , 'count':  400 },
            { 'language':'Ruby on Rails' , 'count': 300 },
            { 'language': 'Visual Basic', count: 20 }
        ]};
    
    process_data(example.data);
    
    function process_data(data) {
        var highest = 0,
            radarData = [],
            key,
            entry,
            i,
            radarEntry;
            
        // Get highest count. Our position is normalized based on this
        for (key in data) {
            entry = data[key];
            highest = Math.max(highest, entry.count);
        }
        
        i = 0;
        // Loop through all the entries
        for (key in data) {
            entry = data[key];      // e.g. {'language': 'C++', 'count': 800 }
            radarEntry = {
                'name': entry.language,
                'description': 'Some interesting text here.',
                'links': [ 'http://an.interesting-site.com' ],
                'position': 1 - 0.95 * entry.count / highest,
                'angle': i / (data.length),
                'quadrant': 'languages',
                'count': entry.count
            };

            radarData.push(radarEntry);
            i++; 
        }

        // Render the radar
        radar('#radar',
	    {
		    horizons: [ 'discover', 'assess', 'learn', 'use'],
            quadrants: [ 'languages'],
            width: 600,
            height: 600,
            data: radarData
        });
    }
</script>

</html>
<script>window.$ = window.jQuery = require('./../scripts/jquery-2.2.2.js');</script>
<script>
const crawler = require('./../modules/crawler');
$(crawlBtn).click(function () {
  crawler.crawl();
});
</script>
